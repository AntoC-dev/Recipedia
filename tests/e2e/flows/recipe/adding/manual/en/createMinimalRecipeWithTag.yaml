appId: "com.recipedia"
---
- runFlow:
    file: "../../../../fab/expand.yaml"
    label: "Expand FAB menu"

# FAB ID uses regex pattern because React Native Paper adds suffix on iOS
- tapOn:
    id: "RecipeEdit.*"
    label: "Tap manual recipe add button"

- runFlow:
    file: "../../en/addRecipeImage.yaml"
    label: "Add an image to this recipe"

- tapOn:
    id: "RecipeTitle::CustomTextInput"
    label: "Focus on recipe title input"

- inputText:
    text: "E2E Test Recipe"
    label: "Enter recipe title"

- hideKeyboard:
    label: "Dismiss keyboard"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipeTags::RoundButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll down to find add tag button"

- waitForAnimationToEnd

- tapOn:
    id: "RecipeTags::RoundButton"
    label: "Tap to add tag to recipe"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipeTags::RoundButton"
    direction: DOWN
    speed: 40
    centerElement: true
    label: "Scroll to tag button again to ensure dropdown will be visible"

- waitForAnimationToEnd

- tapOn:
    id: "RecipeTags::List::0::CustomTextInput"
    label: "Focus on first tag input"

- inputText:
    text: "RecipeT"
    label: "Enter the newly created tag name"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- assertVisible:
    id: "RecipeTags::List::0::AutocompleteItem::RecipeTag"
    label: "New tag id is displayed in dropdown"

- assertVisible:
    text: "RecipeTag"
    label: "New tag text is displayed in dropdown"

- tapOn:
    id: "RecipeTags::List::0::AutocompleteItem::RecipeTag"
    label: "Select the new tag"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipeIngredients::AddButton::RoundButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to ingredients section"

- waitForAnimationToEnd

- tapOn:
    id: "RecipeIngredients::AddButton::RoundButton"
    label: "Add an ingredient"

- tapOn:
    id: "RecipeIngredients::0::QuantityInput"
    label: "Focus on ingredient quantity"

- inputText:
    text: "100"
    label: "Enter ingredient quantity"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- tapOn:
    id: "RecipeIngredients::0::NameInput::CustomTextInput"
    label: "Focus on ingredient name"

- inputText:
    text: "Tomatoes"
    label: "Enter ingredient name"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipeTime::NumericTextInput"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to time part"

- waitForAnimationToEnd

- tapOn:
    id: "RecipeTime::NumericTextInput"
    label: "Focus on time input"

- inputText:
    text: "10"
    label: "Enter cooking time"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipePreparation::AddButton::RoundButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to preparation section"

- waitForAnimationToEnd

- tapOn:
    id: "RecipePreparation::AddButton::RoundButton"
    label: "Add preparation step"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipePreparation::EditableStep::0::TextInputContent::CustomTextInput"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to preparation content input"

- waitForAnimationToEnd

- tapOn:
    id: "RecipePreparation::EditableStep::0::TextInputContent::CustomTextInput"
    label: "Focus on preparation content"

- inputText:
    text: "Test preparation step"
    label: "Enter preparation instructions"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- tapOn:
    id: "RecipePreparation::EditableStep::0::Content"
    label: "Tap on preparation content to dismiss keyboard"

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- tapOn:
    id: "Recipe::BottomActionButton"

- assertVisible:
    id: "Recipe::Dialog::Confirm"
    label: "Confirm recipe creation dialog is visible"

- tapOn:
    id: "Recipe::Dialog::Confirm"
    label: "Close the validation dialog"
