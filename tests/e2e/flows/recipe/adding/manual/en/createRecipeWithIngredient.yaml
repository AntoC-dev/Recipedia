appId: "com.recipedia"
---
- runFlow:
    file: "../../../../fab/expand.yaml"
    label: "Expand FAB menu"

# FAB ID uses regex pattern because React Native Paper adds suffix on iOS
- tapOn:
    id: "RecipeEdit.*"
    label: "Tap manual recipe add button"

- runFlow:
    file: "../../en/addRecipeImage.yaml"
    label: "Add an image to this recipe"

- tapOn:
    id: "RecipeTitle::CustomTextInput"
    label: "Focus on recipe title input"

- inputText:
    text: "E2E Test Recipe"
    label: "Enter recipe title"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- waitForAnimationToEnd:
    label: "Wait for screen to settle after keyboard dismissal"

- scrollUntilVisible:
    element:
      id: "RecipeIngredients::AddButton::RoundButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to ingredients section"

- tapOn:
    id: "RecipeIngredients::AddButton::RoundButton"
    label: "Add an ingredient"

- tapOn:
    id: "RecipeIngredients::0::QuantityInput"
    label: "Focus on ingredient quantity"

- inputText:
    text: "100"
    label: "Enter ingredient quantity"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- tapOn:
    id: "RecipeIngredients::0::NameInput::CustomTextInput"
    label: "Focus on ingredient name"

- inputText:
    text: "RecipeIng"
    label: "Enter the newly created ingredient name"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- assertVisible:
    id: "RecipeIngredients::0::NameInput::AutocompleteItem::RecipeIngredient"
    label: "New ingredient id is displayed in dropdown"

- assertVisible:
    text: "RecipeIngredient"
    label: "New ingredient text is displayed in dropdown"

- tapOn:
    id: "RecipeIngredients::0::NameInput::AutocompleteItem::RecipeIngredient"
    label: "Select the new ingredient"

- scrollUntilVisible:
    element:
      id: "RecipeTime::NumericTextInput"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to recipe time secrion"

- tapOn:
    id: "RecipeTime::NumericTextInput"
    label: "Focus on time input"

- inputText:
    text: "10"
    label: "Enter cooking time"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- scrollUntilVisible:
    element:
      id: "RecipePreparation::AddButton::RoundButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to preparation section"

- tapOn:
    id: "RecipePreparation::AddButton::RoundButton"
    label: "Add preparation step"

- scrollUntilVisible:
    element:
      id: "RecipePreparation::EditableStep::0::TextInputContent::CustomTextInput"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to preparation content input"

- tapOn:
    id: "RecipePreparation::EditableStep::0::TextInputContent::CustomTextInput"
    label: "Focus on preparation content"

- inputText:
    text: "Test preparation step"
    label: "Enter preparation instructions"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- pressKey: enter

- waitForAnimationToEnd:
    label: "Wait for keyboard to dismiss"

- scrollUntilVisible:
    element:
      id: "Recipe::BottomActionButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to validate button"

- tapOn:
    id: "Recipe::BottomActionButton"

- tapOn:
    id: "Recipe::Dialog::Confirm"
    label: "Close the validation dialog"
