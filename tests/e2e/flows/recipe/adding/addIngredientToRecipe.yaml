appId: "com.recipedia"
---

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipeIngredients::AddButton::RoundButton"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to ingredients section"

- waitForAnimationToEnd

- tapOn:
    id: "RecipeIngredients::AddButton::RoundButton"
    label: "Add ingredient"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "RecipeIngredients::${INDEX}::QuantityInput"
    direction: UP
    speed: 40
    centerElement: true
    label: "Scroll up to ingredient input"

- waitForAnimationToEnd

- tapOn:
    id: "RecipeIngredients::${INDEX}::QuantityInput"
    label: "Focus on ingredient quantity"

- runFlow:
    when:
      visible:
        id: "RecipeIngredients::${INDEX}::QuantityInput"
        text: ".+"
    commands:
      - eraseText:
          label: "Erase the existing ingredient quantity"
      - waitForAnimationToEnd:
          label: "Wait for keyboard animation"
      - tapOn:
          id: "RecipeIngredients::${INDEX}::QuantityInput"
          label: "Re-focus field after erase"
      - runFlow:
          file: "../../waitForKeyboardNumeric.yaml"
          label: "Wait for numeric keyboard to appear"

- inputText:
    text: "${QUANTITY}"
    label: "Enter ingredient quantity"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- assertVisible:
    id: "RecipeIngredients::${INDEX}::QuantityInput"
    text: "${QUANTITY}"
    label: "Verify ingredient quantity"

- pressKey: enter

- runFlow:
    file: "../../waitForKeyboardNumericDismiss.yaml"
    label: "Wait for numeric keyboard to dismiss"

- tapOn:
    id: "RecipeIngredients::${INDEX}::NameInput::CustomTextInput"
    label: "Focus on ingredient name"

- runFlow:
    when:
      visible:
        id: "RecipeIngredients::${INDEX}::NameInput::CustomTextInput"
        text: ".+"
    commands:
      - eraseText:
          label: "Erase the existing ingredient name"
      - waitForAnimationToEnd:
          label: "Wait for keyboard animation"
      - tapOn:
          id: "RecipeIngredients::${INDEX}::NameInput::CustomTextInput"
          label: "Re-focus field after erase"
      - runFlow:
          file: "../../waitForKeyboard.yaml"
          label: "Wait for keyboard to appear"
- inputText:
    text: "${NAME}"
    label: "Enter ingredient name"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- assertVisible:
    id: "RecipeIngredients::${INDEX}::NameInput::CustomTextInput"
    text: "${NAME}"
    label: "Verify ingredient name is well edited"

- pressKey: "ENTER"

- runFlow:
    file: "../../waitForKeyboardDismiss.yaml"
    label: "Wait for keyboard to dismiss"
