name: "1 - Web Invalid URL"
appId: "com.recipedia"
tags:
  - web
  - edge-case
---
- runFlow:
    file: "../../flows/setupFirstTest.yaml"
    label: "Setup - Launch app and wait for ready"

- runFlow:
    file: "../../flows/recipe/adding/web/openUrlDialog.yaml"
    label: "Action - Open URL dialog"

- tapOn:
    id: "VerticalBottomButtons::UrlDialog::Input::CustomTextInput"
    label: "Action - Focus on URL input"

- runFlow:
    file: "../../flows/waitForKeyboard.yaml"
    label: "Wait for keyboard to appear"

- inputText:
    text: "not-a-valid-url"
    label: "Action - Enter invalid URL"

- waitForAnimationToEnd:
    label: "Wait for keyboard animation"

- assertVisible:
    id: "VerticalBottomButtons::UrlDialog::Input::CustomTextInput"
    text: "not-a-valid-url"
    label: "Invalid URL is well presend in the text input"

- runFlow:
    when:
      platform: Android
    commands:
      - hideKeyboard:
          label: "Dismiss keyboard on Android"

- runFlow:
    when:
      platform: iOS
    commands:
      - tapOn:
          id: "Done"
          label: "Tap Done key to dismiss keyboard on iOS"

- runFlow:
    file: "../../flows/waitForKeyboardDismiss.yaml"
    label: "Wait for keyboard to dismiss"

- tapOn:
    id: "VerticalBottomButtons::UrlDialog::SubmitButton"
    label: "Try to import the recipe with an invalid URL"

- assertVisible:
    id: "VerticalBottomButtons::UrlDialog::HelperText"
    label: "Assert - Error helper text is visible"

- assertVisible:
    id: "VerticalBottomButtons::UrlDialog::HelperText"
    text: "Please enter a valid URL"
    label: "Assert - Invalid URL error message is displayed"

- tapOn:
    id: "VerticalBottomButtons::UrlDialog::CancelButton"
    label: "Cleanup - Close dialog"

- assertNotVisible:
    id: "VerticalBottomButtons::UrlDialog::Title"
    label: "Assert - Dialog is closed"
