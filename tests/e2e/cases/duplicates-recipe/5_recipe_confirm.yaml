name: "5 - Duplicate Recipe Confirm Flow"
appId: "com.recipedia"
tags:
  - duplicates
---
- runFlow:
    file: "../../flows/setupTest.yaml"
    label: "Setup - Launch app and wait for ready"

- runFlow:
    file: "../../flows/recipe/deleteRecipeBySearchIfExists.yaml"
    env:
      SEARCH_TEXT: "Test Recipe"
    label: "Cleanup - Remove any leftover Test Recipe from previous runs"

- runFlow:
    file: "../../flows/recipe/adding/createBaseRecipeForDuplicateTests.yaml"
    label: "Action - Create base recipe"

- runFlow:
    file: "../../asserts/alerts/en/recipeAddedToDatabase.yaml"
    env:
      RECIPE_NAME: ".*"
    label: "Assert - Verify recipe added to database"

- runFlow:
    file: "../../flows/recipe/verifyRecipeExistsInSearch.yaml"
    env:
      SEARCH_TEXT: "Test Recipe"
    label: "Verify - Confirm recipe is searchable before duplicate test"

- runFlow:
    file: "../../flows/recipe/adding/createBaseRecipeForDuplicateTests.yaml"
    label: "Action - Create duplicate recipe"

- runFlow:
    file: "../../asserts/alerts/en/recipeSimilarFound.yaml"
    label: "Assert - Verify duplicate alert appears"

- tapOn:
    id: "Recipe::Dialog::Confirm"
    label: "Action - Confirm adding recipe despite duplicate"

- tapOn:
    id: "Recipe::Dialog::Confirm"
    label: "Action - Confirm success message"

- runFlow:
    file: "../../flows/recipe/deleteRecipeBySearch.yaml"
    env:
      SEARCH_TEXT: "Test Recipe"
    label: "Cleanup - Delete first Test Recipe"

- runFlow:
    file: "../../flows/recipe/deleteRecipeBySearch.yaml"
    env:
      SEARCH_TEXT: "Test Recipe"
    label: "Cleanup - Delete second Test Recipe"

- tapOn:
    id: "BottomTabs::Home"
    label: "Cleanup - Return to Home screen"
