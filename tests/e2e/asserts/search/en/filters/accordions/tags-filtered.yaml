appId: "com.recipedia"
---

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      text: "Tags.*"
    direction: DOWN
    speed: 60
    centerElement: true
    label: "Scroll to Tags accordion"

- waitForAnimationToEnd

# Assert accordion is displayed
- assertVisible:
    id: "SearchScreen::FilterAccordion::Accordion::${output.accordionIndex}"
    label: "Tags accordion is displayed"

- runFlow:
    when:
      platform: Android
    commands:
      - assertVisible:
          id: "SearchScreen::FilterAccordion::Accordion::${output.accordionIndex}"
          text: "Tags"
          label: "Tags accordion title on Android"

- runFlow:
    when:
      platform: iOS
    commands:
      - assertVisible:
          id: "SearchScreen::FilterAccordion::Accordion::${output.accordionIndex}"
          text: "Tags, ó°…€"
          label: "Tags accordion title with chevron on iOS"

# Expand the accordion
- tapOn:
    id: "SearchScreen::FilterAccordion::Accordion::${output.accordionIndex}"
    label: "Expand Tags accordion"

# Initialize counter for visible items
- evalScript: ${output.itemIndex = 0}

# Item: Breakfast
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Breakfast') == true }
    file: "tags-items/breakfast-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}


- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Breakfast')=== undefined}
    file: "tags-items/breakfast-hidden.yaml"

# Item: Chocolate
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Chocolate') == true}
    file: "tags-items/chocolate-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Chocolate')=== undefined}
    file: "tags-items/chocolate-hidden.yaml"

# Item: Dessert
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Dessert') == true}
    file: "tags-items/dessert-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Dessert')=== undefined}
    file: "tags-items/dessert-hidden.yaml"

# Item: Dinner
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Dinner') == true}
    file: "tags-items/dinner-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Dinner')== false}
    file: "tags-items/dinner-hidden.yaml"

# Item: Healthy
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Healthy') == true}
    file: "tags-items/healthy-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Healthy')== false}
    file: "tags-items/healthy-hidden.yaml"

# Item: Indian
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Indian') == true}
    file: "tags-items/indian-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Indian')== false}
    file: "tags-items/indian-hidden.yaml"

# Item: Italian
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Italian') == true}
    file: "tags-items/italian-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Italian')== false}
    file: "tags-items/italian-hidden.yaml"

# Item: Japanese
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Japanese') == true}
    file: "tags-items/japanese-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Japanese')== false}
    file: "tags-items/japanese-hidden.yaml"

# Item: Lunch
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Lunch') == true}
    file: "tags-items/lunch-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Lunch')== false}
    file: "tags-items/lunch-hidden.yaml"

# Item: Mexican
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Mexican') == true}
    file: "tags-items/mexican-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Mexican')== false}
    file: "tags-items/mexican-hidden.yaml"

# Item: Quick Meal
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Quick Meal') == true}
    file: "tags-items/quickMeal-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Quick Meal')== false}
    file: "tags-items/quickMeal-hidden.yaml"

# Item: Salad
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Salad') == true}
    file: "tags-items/salad-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Salad')== false}
    file: "tags-items/salad-hidden.yaml"

# Item: Seafood
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Seafood') == true}
    file: "tags-items/seafood-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Seafood')== false}
    file: "tags-items/seafood-hidden.yaml"

# Item: Soup
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Soup') == true}
    file: "tags-items/soup-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Soup')== false}
    file: "tags-items/soup-hidden.yaml"

# Item: Vegetarian
- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Vegetarian') == true}
    file: "tags-items/vegetarian-visible.yaml"
    env:
      ITEM_INDEX: ${output.itemIndex}

- runFlow:
    when:
      true: ${VISIBLE_ITEMS.split(',').find(item => item === 'Vegetarian')== false}
    file: "tags-items/vegetarian-hidden.yaml"

- waitForAnimationToEnd

- scrollUntilVisible:
    element:
      id: "SearchScreen::FilterAccordion::Accordion::${output.accordionIndex}"
    direction: UP
    speed: 60
    centerElement: true
    label: "Scroll back up to accordion header"

- waitForAnimationToEnd

# Collapse the accordion back
- tapOn:
    id: "SearchScreen::FilterAccordion::Accordion::${output.accordionIndex}"
    label: "Collapse Tags accordion"

# Increment accordion index for next accordion
- evalScript: ${output.accordionIndex = output.accordionIndex + 1}
